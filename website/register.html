<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Register - Jewelry obelisco</title>
  <link rel="icon" href="assets/LO.ico" />
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <style>
    .register-container {
      max-width: 600px;
      margin: 40px auto;
      padding: 30px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.03);
      border-radius: 8px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #000;
      font-weight: 600;
    }
    .form-group input, .form-group select {
      width: 100%;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.1);
      background: rgba(0,0,0,0.3);
      color: var(--text);
      font-size: 1rem;
    }
    .form-group input:focus, .form-group select:focus {
      outline: none;
      border-color: var(--accent);
    }
    .password-requirements {
      font-size: 0.85rem;
      color: var(--muted);
      margin-top: 5px;
    }
    .password-requirements.valid {
      color: #4ade80;
    }
    .password-requirements.invalid {
      color: #f87171;
    }
    .error-message {
      color: #f87171;
      font-size: 0.9rem;
      margin-top: 5px;
      display: none;
    }
    .success-message {
      background: rgba(74, 222, 128, 0.1);
      border: 1px solid rgba(74, 222, 128, 0.3);
      color: #4ade80;
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 20px;
      display: none;
    }
    .btn-register {
      width: 100%;
      padding: 14px;
      background: var(--accent);
      color: #111;
      border: none;
      border-radius: 6px;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s;
    }
    .btn-register:hover {
      background: var(--accent-dark);
    }
    .login-link {
      text-align: center;
      margin-top: 20px;
      color: var(--muted);
    }
    .login-link a {
      color: var(--accent);
      text-decoration: none;
    }
  </style>
</head>
<body>
  <header>
    <div class="top-header">
      <div style="display:flex;align-items:center;gap:12px">
        <img src="assets/LO.ico" alt="Logo obelisco" class="logo" />
        <h1><a href="index.html" style="color:inherit;text-decoration:none;cursor:pointer">OBELISCO</a></h1>
      </div>
      <div style="display:flex;align-items:center;gap:12px">
        <span id="datetime-display" style="color:var(--muted);font-size:0.9rem;margin-right:10px"></span>
        <a href="login.html" style="color:var(--text);text-decoration:none;margin-right:8px">Login</a>
        <a href="cart.html" style="color:var(--text);text-decoration:none">Cart (<span id="cart-count">0</span>)</a>
      </div>
    </div>
    <nav>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="catalogo.html">Catalog</a></li>
        <li><a href="register.html" class="active">Register</a></li>
        <li><a href="contacto.html">Contact</a></li>
      </ul>
    </nav>
  </header>

  <div class="register-container">
    <h2 style="text-align:center;margin-bottom:30px">Create Your Account</h2>
    
    <div id="success-msg" class="success-message"></div>
    
    <form id="register-form">
      <div class="form-group">
        <label for="firstName">First Name *</label>
        <input type="text" id="firstName" name="firstName" required minlength="2">
        <div class="error-message" id="error-firstName"></div>
      </div>

      <div class="form-group">
        <label for="lastName">Last Name *</label>
        <input type="text" id="lastName" name="lastName" required minlength="2">
        <div class="error-message" id="error-lastName"></div>
      </div>

      <div class="form-group">
        <label for="email">Email Address *</label>
        <input type="email" id="email" name="email" required>
        <div class="error-message" id="error-email"></div>
      </div>

      <div class="form-group">
        <label for="age">Age *</label>
        <input type="number" id="age" name="age" required min="13" max="120">
        <div class="error-message" id="error-age"></div>
      </div>

      <div class="form-group">
        <label for="phone">Phone Number</label>
        <input type="tel" id="phone" name="phone" placeholder="+1 (555) 123-4567">
      </div>

      <div class="form-group">
        <label for="country">Country *</label>
        <select id="country" name="country" required>
          <option value="">Select Country</option>
          <option value="us">United States</option>
          <option value="ca">Canada</option>
          <option value="uk">United Kingdom</option>
          <option value="co">Colombia</option>
          <option value="mx">Mexico</option>
          <option value="other">Other</option>
        </select>
      </div>

      <div class="form-group">
        <label for="username">Username *</label>
        <input type="text" id="username" name="username" required minlength="4" maxlength="20">
        <div class="error-message" id="error-username"></div>
      </div>

      <div class="form-group">
        <label for="password">Password *</label>
        <input type="password" id="password" name="password" required>
        <div class="password-requirements" id="password-reqs">
          Password must contain:
          <ul style="margin:5px 0;padding-left:20px">
            <li id="req-length">At least 8 characters</li>
            <li id="req-uppercase">One uppercase letter</li>
            <li id="req-lowercase">One lowercase letter</li>
            <li id="req-number">One number</li>
            <li id="req-special">One special character (!@#$%^&*)</li>
          </ul>
        </div>
        <div class="error-message" id="error-password"></div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm Password *</label>
        <input type="password" id="confirmPassword" name="confirmPassword" required>
        <div class="error-message" id="error-confirmPassword"></div>
      </div>

      <div class="form-group">
        <label style="display:flex;align-items:center;gap:8px">
          <input type="checkbox" id="terms" name="terms" required style="width:auto">
          <span>I agree to the Terms and Conditions *</span>
        </label>
        <div class="error-message" id="error-terms"></div>
      </div>

      <div class="form-group">
        <label style="display:flex;align-items:center;gap:8px">
          <input type="checkbox" id="newsletter" name="newsletter" style="width:auto">
          <span>Subscribe to newsletter for exclusive offers</span>
        </label>
      </div>

      <button type="submit" class="btn-register">Create Account</button>
    </form>

    <div class="login-link">
      Already have an account? <a href="login.html">Login here</a>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <p class="p1">Â© JEWELRY OBELISCO. All rights reserved.</p>
    </div>
  </footer>

  <script src="cart.js"></script>
  <script>
    // Real-time password validation with regex
    const passwordInput = document.getElementById('password');
    const passwordReqs = document.getElementById('password-reqs');
    
    const regexPatterns = {
      length: /.{8,}/,
      uppercase: /[A-Z]/,
      lowercase: /[a-z]/,
      number: /[0-9]/,
      special: /[!@#$%^&*]/
    };

    passwordInput.addEventListener('input', function() {
      const password = this.value;
      
      // Check each requirement
      document.getElementById('req-length').style.color = regexPatterns.length.test(password) ? '#4ade80' : '#f87171';
      document.getElementById('req-uppercase').style.color = regexPatterns.uppercase.test(password) ? '#4ade80' : '#f87171';
      document.getElementById('req-lowercase').style.color = regexPatterns.lowercase.test(password) ? '#4ade80' : '#f87171';
      document.getElementById('req-number').style.color = regexPatterns.number.test(password) ? '#4ade80' : '#f87171';
      document.getElementById('req-special').style.color = regexPatterns.special.test(password) ? '#4ade80' : '#f87171';
    });

    // Form validation and submission
    document.getElementById('register-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Clear previous errors
      document.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');
      
      let isValid = true;
      const formData = new FormData(this);
      
      // Validate first name
      const firstName = formData.get('firstName').trim();
      if (firstName.length < 2) {
        showError('error-firstName', 'First name must be at least 2 characters');
        isValid = false;
      }
      
      // Validate last name
      const lastName = formData.get('lastName').trim();
      if (lastName.length < 2) {
        showError('error-lastName', 'Last name must be at least 2 characters');
        isValid = false;
      }
      
      // Validate email
      const email = formData.get('email').trim();
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        showError('error-email', 'Please enter a valid email address');
        isValid = false;
      }
      
      // Validate age
      const age = parseInt(formData.get('age'));
      if (age < 13 || age > 120) {
        showError('error-age', 'Age must be between 13 and 120');
        isValid = false;
      }
      
      // Validate username
      const username = formData.get('username').trim();
      const usernameRegex = /^[a-zA-Z0-9_]{4,20}$/;
      if (!usernameRegex.test(username)) {
        showError('error-username', 'Username must be 4-20 characters (letters, numbers, underscore only)');
        isValid = false;
      }
      
      // Validate password with regex
      const password = formData.get('password');
      const passwordValid = Object.values(regexPatterns).every(pattern => pattern.test(password));
      if (!passwordValid) {
        showError('error-password', 'Password does not meet all requirements');
        isValid = false;
      }
      
      // Validate password confirmation
      const confirmPassword = formData.get('confirmPassword');
      if (password !== confirmPassword) {
        showError('error-confirmPassword', 'Passwords do not match');
        isValid = false;
      }
      
      // Validate terms
      if (!formData.get('terms')) {
        showError('error-terms', 'You must agree to the terms and conditions');
        isValid = false;
      }
      
      if (isValid) {
        // Store user data in localStorage
        const users = JSON.parse(localStorage.getItem('registered_users') || '[]');
        
        // Check if username or email already exists
        if (users.some(u => u.username === username)) {
          showError('error-username', 'Username already taken');
          return;
        }
        if (users.some(u => u.email === email)) {
          showError('error-email', 'Email already registered');
          return;
        }
        
        const userData = {
          firstName,
          lastName,
          email,
          age,
          phone: formData.get('phone'),
          country: formData.get('country'),
          username,
          password, // In production, this should be hashed!
          newsletter: formData.get('newsletter') === 'on',
          registeredAt: new Date().toISOString()
        };
        
        users.push(userData);
        localStorage.setItem('registered_users', JSON.stringify(users));
        
        // Show success message
        const successMsg = document.getElementById('success-msg');
        successMsg.textContent = `Account created successfully! Welcome, ${firstName}! Redirecting to login...`;
        successMsg.style.display = 'block';
        
        // Reset form
        this.reset();
        
        // Redirect to login after 2 seconds
        setTimeout(() => {
          window.location.href = 'login.html';
        }, 2000);
      }
    });
    
    function showError(elementId, message) {
      const errorEl = document.getElementById(elementId);
      errorEl.textContent = message;
      errorEl.style.display = 'block';
    }

    // Real-time date & time display
    function updateDateTime() {
      const now = new Date();
      const options = { 
        weekday: 'short', 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      };
      document.getElementById('datetime-display').textContent = now.toLocaleDateString('en-US', options);
    }
    
    updateDateTime();
    setInterval(updateDateTime, 1000);
  </script>
</body>
</html>
